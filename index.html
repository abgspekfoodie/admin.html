<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Snapbite Admin</title>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 2rem;
            background-color: #2f2f2f;
            color: #fff;
        }
        h1 {
            color: #ff9500;
            text-align: center;
        }
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            max-width: 1000px;
            margin: 0 auto;
        }
        .menu-item, .status-toggle, .offday-toggle, .sales-summary, .button {
            margin: 1rem 0;
        }
        .menu-item, .sales-summary {
            display: flex;
            justify-content: space-between;
            width: 100%;
        }
        .button {
            padding: 12px 24px;
            background-color: #ff9500;
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        select, input {
            width: 100%;
            padding: 10px;
            background-color: #444;
            color: #fff;
            border: none;
            border-radius: 5px;
        }
        .menu-item label, .sales-summary label {
            font-weight: 600;
        }
        .status-toggle, .offday-toggle {
            margin-top: 1rem;
        }
        .status-toggle label, .offday-toggle label {
            display: block;
            margin: 0.5rem 0;
        }
    </style>
</head>
<body>
    <h1>Snapbiteâ„¢ Admin Dashboard</h1>
    <div class="container">
        <!-- Toggle Available/Item 86 -->
        <div class="status-toggle">
            <label for="menu-status">Menu Availability Status:</label>
            <select id="menu-status">
                <option value="available">Available</option>
                <option value="item-86">Item 86</option>
            </select>
        </div>

        <!-- Off Day Toggle -->
        <div class="offday-toggle">
            <label for="offday-status">Off Day:</label>
            <input type="checkbox" id="offday-status">
        </div>

        <!-- Sales Summary -->
        <div class="sales-summary">
            <div><label>Total Sales: RM <span id="total-sales">0.00</span></label></div>
            <div><label>Gross Profit: RM <span id="gross-profit">0.00</span></label></div>
            <div><label>Net Profit: RM <span id="net-profit">0.00</span></label></div>
        </div>

        <!-- Button to Save or Update Data -->
        <button class="button" id="update-button">Update Sales</button>
    </div>

    <script>
        const databaseURL = "https://snapbite-admin-default-rtdb.asia-southeast1.firebasedatabase.app/";
        
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyB_gnrfNMlJaNu6zSZqX7eiXzbZrnmtA2M",
            authDomain: "snapbite-admin.firebaseapp.com",
            databaseURL: databaseURL,
            projectId: "snapbite-admin",
            storageBucket: "snapbite-admin.firebasestorage.app",
            messagingSenderId: "146625734660",
            appId: "1:146625734660:web:23ada593e4818ed7332d51",
            measurementId: "G-7RR3W1WJYK"
        };

        // Firebase initialization
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Fetch menu data
        db.ref('menu').on('value', snapshot => {
            const menuData = snapshot.val();
            if (menuData) {
                let totalSales = 0;
                let grossProfit = 0;
                let netProfit = 0;

                // Update menu availability status and sales summary
                Object.entries(menuData).forEach(([menuName, menuDetails]) => {
                    const { price, available, sales } = menuDetails;

                    totalSales += price * sales;
                    grossProfit += (price * sales) - (menuDetails.cost * sales);
                    netProfit += grossProfit - (sales * menuDetails.operationalCosts);

                    const menuItemDiv = document.createElement('div');
                    menuItemDiv.classList.add('menu-item');
                    menuItemDiv.innerHTML = `
                        <label>${menuName} (${available ? 'Available' : 'Item 86'})</label>
                        <div>Sold: ${sales}</div>
                    `;
                    document.body.appendChild(menuItemDiv);
                });

                // Update sales summary
                document.getElementById("total-sales").textContent = totalSales.toFixed(2);
                document.getElementById("gross-profit").textContent = grossProfit.toFixed(2);
                document.getElementById("net-profit").textContent = netProfit.toFixed(2);
            }
        });

        // Handle toggle and update button actions
        document.getElementById("update-button").addEventListener("click", () => {
            const selectedStatus = document.getElementById("menu-status").value;
            const isOffDay = document.getElementById("offday-status").checked;

            // Update Firebase with changes
            db.ref('settings').update({
                menuStatus: selectedStatus,
                offDay: isOffDay
            });

            alert("Data updated successfully!");
        });
    </script>
</body>
</html>
