<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Snapbite™ Admin Panel</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background-color: #121212;
      color: #f5f5f5;
    }
    header {
      background-color: #1f1f1f;
      color: gold;
      padding: 1rem 2rem;
      text-align: center;
      font-size: 1.8rem;
      font-weight: 600;
    }
    .container {
      padding: 2rem;
      max-width: 1200px;
      margin: auto;
    }
    .category {
      margin-bottom: 2rem;
      border-bottom: 1px solid #333;
      padding-bottom: 1rem;
    }
    .category h2 {
      color: #ffcc00;
      border-left: 5px solid purple;
      padding-left: 10px;
    }
    .item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #1e1e1e;
      margin: 0.5rem 0;
      padding: 1rem;
      border-radius: 8px;
    }
    .item .name {
      font-weight: 600;
    }
    .switch {
      display: flex;
      align-items: center;
    }
    .switch input {
      margin-right: 10px;
      transform: scale(1.5);
    }
    .summary {
      background: #1f1f1f;
      padding: 1rem;
      margin-top: 2rem;
      border-radius: 8px;
    }
    .summary h3 {
      color: gold;
      margin-bottom: 1rem;
    }
    .summary p {
      margin: 0.5rem 0;
    }
    .offday-btn {
      background: red;
      color: #fff;
      padding: 0.8rem 1.5rem;
      border: none;
      border-radius: 5px;
      font-weight: bold;
      margin-top: 1rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header>Snapbite™ Admin Panel <br><small style="font-size:14px;color:gray;">No Rules. Just Bite. Repeat</small></header>
  <div class="container" id="panel">
    <!-- JS will inject categories and items here -->
  </div>
  <div class="container summary" id="summary">
    <h3>Sales Summary</h3>
    <p>Total Items Sold: <span id="totalSold">0</span></p>
    <p>Gross Sales: RM <span id="grossSales">0.00</span></p>
    <p>Net Profit: RM <span id="netProfit">0.00</span></p>
    <p>PNL This Month: RM <span id="pnl">0.00</span></p>
    <button class="offday-btn" onclick="toggleOffday()">Toggle Off Day</button>
  </div>  <script>
    const dbUrl = 'https://snapbite-admin-default-rtdb.asia-southeast1.firebasedatabase.app/items.json';

    const categories = {
      "Beef Series": ["Primebite", "Beef N' Cheese", "The Fun Guy", "The Fixer"],
      "Chicken Series": ["Chickbite", "Goldcut", "The Cap Cut", "Stripstack"],
      "Tex-Mex Series": ["Smoke Beef Taco", "Smokey Chop Taco", "Mix Taco", "Smoke Beef Quesadilla", "Smoke Chicken Quesadilla", "Mix Quesadilla"],
      "Sausage Series": ["Classic Sausage", "Chickola"],
      "Snack Series": ["Popcorn Chicken"],
      "Add-ons": ["Cheese", "Egg", "Mushroom", "Bacon"]
    };

    async function loadItems() {
      const res = await fetch(dbUrl);
      const data = await res.json();
      const panel = document.getElementById('panel');
      panel.innerHTML = '';
      for (let cat in categories) {
        const catDiv = document.createElement('div');
        catDiv.className = 'category';
        catDiv.innerHTML = `<h2>${cat}</h2>`;

        categories[cat].forEach(name => {
          const itemData = data?.[name] || {};
          const available = itemData.available !== false;
          const sold = itemData.sold || 0;

          const itemDiv = document.createElement('div');
          itemDiv.className = 'item';
          itemDiv.innerHTML = `
            <span class="name">${name}</span>
            <div class="switch">
              <input type="checkbox" id="${name}" ${available ? 'checked' : ''} onchange="toggleItem('${name}', this.checked)">
              <label for="${name}">${available ? 'Available' : 'Item 86'}</label>
            </div>
            <div class="sold">Sold: ${sold}</div>
          `;
          catDiv.appendChild(itemDiv);
        });

        panel.appendChild(catDiv);
      }
      calculateSummary(data);
    }

    function toggleItem(name, isAvailable) {
      fetch(`https://snapbite-admin-default-rtdb.asia-southeast1.firebasedatabase.app/items/${name}.json`, {
        method: 'PATCH',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ available: isAvailable })
      });
    }

    function toggleOffday() {
      alert('Reminder: Manually untick each item if you are off today.');
    }

    function calculateSummary(data) {
      let total = 0, gross = 0;
      const costPerItem = 4.00;
      for (let key in data) {
        const sold = data[key].sold || 0;
        total += sold;
        gross += sold * (data[key].price || 10);
      }
      const net = gross - (total * costPerItem);
      document.getElementById('totalSold').textContent = total;
      document.getElementById('grossSales').textContent = gross.toFixed(2);
      document.getElementById('netProfit').textContent = net.toFixed(2);
      document.getElementById('pnl').textContent = net.toFixed(2);
    }

    loadItems();
  </script></body>
</html>
