<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Snapbite™ Admin Panel</title>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<style>
  body {
    font-family: 'Arial', sans-serif;
    background: #0e0e0e;
    color: #fff;
    padding: 2rem;
  }
  h1 {
    color: #ff9500;
    margin-bottom: 1rem;
    text-align: center;
  }
  section {
    margin-bottom: 2rem;
    background: #1e1e1e;
    padding: 1rem;
    border-radius: 10px;
  }
  h2 {
    border-bottom: 2px solid #ff9500;
    padding-bottom: 0.3rem;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 0.7rem;
  }
  th, td {
    padding: 0.5rem;
    border: 1px solid #333;
    text-align: left;
  }
  th {
    background: #222;
    color: #ff9500;
  }
  input[type=checkbox] {
    transform: scale(1.2);
    cursor: pointer;
  }
  .summary-box p {
    font-size: 1.1rem;
    margin: 0.4rem 0;
  }
  #offdayToggle {
    margin-top: 1rem;
    display: flex;
    align-items: center;
  }
  #offdayToggle label {
    font-weight: bold;
    margin-left: 0.5rem;
    cursor: pointer;
  }
</style>
</head>
<body>
  <h1>Snapbite™ Admin Panel</h1>

  <section id="menuSection">
    <h2>Menu Availability</h2>
    <table id="menuTable">
      <thead>
        <tr>
          <th>Name</th>
          <th>Category</th>
          <th>Price (RM)</th>
          <th>Available</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <section id="sideSection">
    <h2>Side Items Availability</h2>
    <table id="sideTable">
      <thead>
        <tr>
          <th>Name</th>
          <th>Price (RM)</th>
          <th>Available</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <section id="salesSection">
    <h2>Sales Summary</h2>
    <div class="summary-box">
      <p><strong>Gross Sales:</strong> RM <span id="grossSales">0.00</span></p>
      <p><strong>Net Sales:</strong> RM <span id="netSales">0.00</span></p>
      <p><strong>Gross Profit:</strong> RM <span id="grossProfit">0.00</span></p>
      <p><strong>Net Profit:</strong> RM <span id="netProfit">0.00</span></p>
    </div>
  </section>

  <section id="offdaySection">
    <input type="checkbox" id="offdayCheckbox" />
    <label for="offdayCheckbox">Mark Today as Off Day</label>
  </section>

<script>
  // Firebase config — gantikan dengan config kau
  const firebaseConfig = {
    apiKey: "AIzaSyB_gnrfNMlJaNu6zSZqX7eiXzbZrnmtA2M",
    authDomain: "snapbite-admin.firebaseapp.com",
    databaseURL: "https://snapbite-admin-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "snapbite-admin",
    storageBucket: "snapbite-admin.appspot.com",
    messagingSenderId: "146625734660",
    appId: "1:146625734660:web:23ada593e4818ed7332d51"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // Render menu table from /menus node
  function renderMenus() {
    db.ref("menus").on("value", snapshot => {
      const menus = snapshot.val() || {};
      const tbody = document.querySelector("#menuTable tbody");
      tbody.innerHTML = "";
      Object.entries(menus).forEach(([key, menu]) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${menu.name}</td>
          <td>${menu.category || ''}</td>
          <td>${menu.price.toFixed(2)}</td>
          <td><input type="checkbox" data-key="${key}" ${menu.available ? 'checked' : ''}></td>
        `;
        tbody.appendChild(tr);
      });

      // Attach event listeners for toggle availability
      tbody.querySelectorAll('input[type="checkbox"]').forEach(chk => {
        chk.addEventListener("change", e => {
          const key = e.target.getAttribute("data-key");
          const val = e.target.checked;
          db.ref(`menus/${key}/available`).set(val);
        });
      });
    });
  }

  // Render side items table from /sides node
  function renderSides() {
    db.ref("sides").on("value", snapshot => {
      const sides = snapshot.val() || {};
      const tbody = document.querySelector("#sideTable tbody");
      tbody.innerHTML = "";
      Object.entries(sides).forEach(([key, side]) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${side.name}</td>
          <td>${side.price.toFixed(2)}</td>
          <td><input type="checkbox" data-key="${key}" ${side.available ? 'checked' : ''}></td>
        `;
        tbody.appendChild(tr);
      });

      // Attach event listeners for toggle availability
      tbody.querySelectorAll('input[type="checkbox"]').forEach(chk => {
        chk.addEventListener("change", e => {
          const key = e.target.getAttribute("data-key");
          const val = e.target.checked;
          db.ref(`sides/${key}/available`).set(val);
        });
      });
    });
  }

  // Load sales summary from /sales node
  function loadSalesSummary() {
    db.ref("sales").on("value", snapshot => {
      const sales = snapshot.val() || {};
      document.getElementById("grossSales").innerText = (sales.grossTotal || 0).toFixed(2);
      document.getElementById("netSales").innerText = (sales.netTotal || 0).toFixed(2);
      document.getElementById("grossProfit").innerText = (sales.grossProfit || 0).toFixed(2);
      document.getElementById("netProfit").innerText = (sales.netProfit || 0).toFixed(2);
    });
  }

  // Offday toggle setup
  function setupOffdayToggle() {
    const checkbox = document.getElementById("offdayCheckbox");
    db.ref("settings/offday").on("value", snap => {
      checkbox.checked = snap.val() === true;
    });
    checkbox.addEventListener("change", () => {
      db.ref("settings/offday").set(checkbox.checked);
    });
  }

  // Init app
  renderMenus();
  renderSides();
  loadSalesSummary();
  setupOffdayToggle();

</script>
</body>
</html>
